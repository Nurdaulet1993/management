import{D as s,E as l,F as v,Fb as c,Gb as y,H as o,Ib as U,M as m,Wb as $,e as h,jb as k,q as f,sa as I,u as g,z as d}from"./chunk-5FGQ34ZG.js";import{a as u}from"./chunk-6DTZ7UCQ.js";var a=new v("core.config"),p=(()=>{let t=class t{constructor(){this.tokenName="accessToken"}getToken(){return localStorage.getItem(this.tokenName)}setToken(e){localStorage.setItem(this.tokenName,e)}removeToken(){localStorage.removeItem(this.tokenName)}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})(),M=(()=>{let t=class t{constructor(){this.http=o(c),this.config=o(a),this.jwtService=o(p),this.endpoint=this.config.isAdmin?`${this.config.apiUrl}/admin/auth`:`${this.config.apiUrl}/auth`,this.currentUser=I(null)}signIn(e,n){return this.http.post(`${this.endpoint}/login`,{email:e,password:n}).pipe(d(r=>{this.jwtService.setToken(r.access_token),this.currentUser.set(r.user)}))}signUp(e,n,r,j){return this.http.post(`${this.endpoint}/sign-up`,{email:e,password:n,firstName:r,lastName:j})}getCurrentUser(){return this.http.get(`${this.endpoint}/user`).pipe(d(e=>this.currentUser.set(e)),f(()=>(this.logout(),h)),g(1))}logout(){this.jwtService.removeToken(),this.currentUser.set(null)}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})(),S=(()=>{let t=class t{static forRoot(e={apiUrl:"http://localhost:3000/api",isAdmin:!1}){return{ngModule:t,providers:[{provide:a,useValue:{apiUrl:e.apiUrl,isAdmin:e.isAdmin}},{provide:k,useFactory:(n,r)=>()=>r.getToken()?n.getCurrentUser():h,multi:!0,deps:[M,p]}]}}};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=m({type:t}),t.\u0275inj=l({providers:[y(U())]});let i=t;return i})();var E=(i,t)=>{let e=o(p).getToken();if(!e)return t(i);let n=i.clone({headers:i.headers.set("Authorization",`Bearer ${e}`)});return t(n)},R=(()=>{let t=class t{constructor(){this.http=o(c),this.config=o(a),this.endpoint=this.config.isAdmin?`${this.config.apiUrl}/admin/products`:`${this.config.apiUrl}/products`}create(e){return this.http.post(this.endpoint,e)}getProducts(e){return this.http.get(this.endpoint,{params:u({},e)})}deleteProduct(e){return this.http.delete(`${this.endpoint}/${e}`)}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})(),C=(()=>{let t=class t{constructor(){this.http=o(c),this.config=o(a),this.endpoint=this.config.isAdmin?`${this.config.apiUrl}/admin/categories`:`${this.config.apiUrl}/categories`,this.categories$=this.http.get(this.endpoint),this.categories=$(this.categories$,{initialValue:[]})}create(e){return this.http.post(this.endpoint,{title:e})}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();export{M as a,S as b,E as c,R as d,C as e};
